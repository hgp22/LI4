@page "/listarleiloes"
@inject NavigationManager NavigationManager
@using Controllers
@inject ILeilaoController leilaoController
@inject IMarcaController marcaController
@inject IModeloController modeloController
@inject IVeiculoController veiculoController
@inject ILicitacaoController licitacaoController

<PageTitle>Auctions</PageTitle>

<div class="text-white">

    <div class="text-3xl font-bold dark:bg-gray-800 p-4 px-16">
        Auctions
    </div>

    <div class="flex items-center justify-center min-h-screen">
        <div style="width: 100rem; height: 30rem;" class="max-w-md">
            <ul class="list-group">
                @foreach (var leilao in leilaoController.GetAll())
                {
                    <li class="list-group-item">
                        <div class="border border-blue-500 mb-8">
                            <div class="grid grid-cols-2 flex p-4">

                                <div class="mx-auto">
                                    <a>Imagem</a>
                                </div>

                                <div class="mx-auto">

                                    <div class="grid mb-4">

                                        <div class="text-l font-bold mb-2">
                                            <button @onclick="(() => VerLeilao(leilao.Id))">
                                                @leilao.Titulo
                                            </button>
                                        </div>

                                        <div class="text-blue-500 text-l mb-2">
                                            <button @onclick="(() => VerLeilao(leilao.Id))">
                                                €@(licitacaoController.GetByID(leilao.IdLicitacaoAtual) == null ? leilao.ValorInicial : licitacaoController.GetByID(leilao.IdLicitacaoAtual).Valor)
                                            </button>
                                        </div>

                                        <div>
                                            <a class="text-xs">
                                                @marcaController.GetById(veiculoController.GetById(leilao.IdVeiculo).IdMarca).Nome
                                                @modeloController.GetById(veiculoController.GetById(leilao.IdVeiculo).IdModelo).Nome
                                                (@veiculoController.GetById(leilao.IdVeiculo).Ano)
                                            </a>
                                        </div>
                                    </div>

                                    <div class="mb-5 border-t"></div>

                                    <div class="font-bold text-xs mb-2">
                                        <button @onclick="(() => VerLeilao(leilao.Id))">
                                            Time Left: (@leilao.DataFinal)
                                        </button>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </li>
                }
            </ul>
        </div>
    </div>

</div>


@code {
    private void VerLeilao(int leilaoId)
    {
        NavigationManager.NavigateTo($"/detalhesleilao/{leilaoId}");
    }
}

